# 08. APIエンドポイント参考

## 1. 概要

このドキュメントは、`food-del-server` が提供する主要なAPIエンドポイントの概要をまとめたものです。ベースURLは `/api` です。

-   `[認証要]`: リクエストヘッダーに有効な `Bearer` トークンが必要です。
-   `[管理者要]`: 管理者（`admin`）権限を持つユーザーのみがアクセス可能です。

---

## 2. 認証 (`/users`)

| METHOD | ENDPOINT                  | 説明                                               | 権限       |
| :----- | :------------------------ | :------------------------------------------------- | :--------- |
| `POST` | `/auth/register`          | ユーザーを新規登録する。                           | 公開       |
| `POST` | `/auth/login`             | ログインし、JWTを取得する。                        | 公開       |
| `POST` | `/auth/logout`            | ログアウトする。                                   | `[認証要]` |
| `POST` | `/auth/refresh`           | 新しいアクセストークンを取得する。                 | 公開       |
| `GET`  | `/profile`                | 自身のプロフィール情報を取得する。                 | `[認証要]` |
| `PUT`  | `/profile`                | 自身のプロフィール情報を更新する。                 | `[認証要]` |
| `POST` | `/auth/change-password`   | パスワードを変更する。                             | `[認証要]` |

---

## 3. カテゴリ (`/categories`)

| METHOD    | ENDPOINT       | 説明                                               | 権限         |
| :-------- | :------------- | :------------------------------------------------- | :----------- |
| `GET`     | `/`            | 全てのカテゴリのリストを取得する。                 | 公開         |
| `GET`     | `/active`      | 有効なカテゴリのみのリストを取得する。             | 公開         |
| `GET`     | `/:id`         | 指定したIDのカテゴリを取得する。                   | 公開         |
| `GET`     | `/:id/foods`   | 指定したカテゴリに属する商品リストを取得する。     | 公開         |
| `POST`    | `/`            | 新しいカテゴリを作成する。                         | `[管理者要]` |
| `PUT`     | `/:id`         | カテゴリ情報を更新する。                           | `[管理者要]` |
| `PATCH`   | `/:id/status`  | カテゴリの有効状態を更新する。                     | `[管理者要]` |
| `DELETE`  | `/:id`         | カテゴリを削除する。                               | `[管理者要]` |

---

## 4. 商品 (`/foods`)

| METHOD   | ENDPOINT         | 説明                                                     | 権限         |
| :------- | :--------------- | :------------------------------------------------------- | :----------- |
| `GET`    | `/`              | 商品のリストをページネーションで取得する。               | 公開         |
| `GET`    | `/featured`      | 注目の商品リストを取得する。                             | 公開         |
| `GET`    | `/:id`           | 指定したIDの商品詳細を取得する。                         | 公開         |
| `GET`    | `/dashboard/all` | 全ての商品リスト（非公開含む）を取得する。               | `[管理者要]` |
| `POST`   | `/`              | 新しい商品を画像付きで作成する。                         | `[管理者要]` |
| `PUT`    | `/:id`           | 商品情報を更新する。                                     | `[管理者要]` |
| `DELETE` | `/:id`           | 商品をソフトデリートする（ステータスを`false`に更新）。 | `[管理者要]` |

---

## 5. カート (`/carts`)

*このセクションの全てのAPIは `[認証要]` です。*

| METHOD    | ENDPOINT       | 説明                               | 権限       |
| :-------- | :------------- | :--------------------------------- | :--------- |
| `GET`     | `/`            | 現在のカート情報を取得する。       | `[認証要]` |
| `POST`    | `/add`         | カートに商品を追加する。           | `[認証要]` |
| `PUT`     | `/items/:id`   | カート内の商品の数量を更新する。   | `[認証要]` |
| `DELETE`  | `/items/:id`   | カートから商品を削除する。         | `[認証要]` |
| `DELETE`  | `/clear`       | カートを空にする。                 | `[認証要]` |
| `POST`    | `/checkout`    | カート内容から注文を作成する。     | `[認証要]` |

---

## 6. 注文 (`/orders`)

| METHOD | ENDPOINT             | 説明                                               | 権限         |
| :----- | :------------------- | :------------------------------------------------- | :----------- |
| `POST` | `/`                  | カート内容から注文を作成する。                     | `[認証要]`   |
| `GET`  | `/`                  | 自身の注文履歴リストを取得する。                   | `[認証要]`   |
| `GET`  | `/:id`               | 自身の特定の注文詳細を取得する。                   | `[認証要]`   |
| `GET`  | `/:id/history`       | 自身の注文のステータス履歴を取得する。             | `[認証要]`   |
| `PUT`  | `/:id/cancel`        | 自身の注文をキャンセルする。                       | `[認証要]`   |
| `GET`  | `/admin/stats`       | 注文統計を取得する。                               | `[管理者要]` |
| `GET`  | `/admin`             | 全てのユーザーの注文リストを取得する。             | `[管理者要]` |
| `GET`  | `/admin/:id`         | 任意の注文詳細を取得する。                         | `[管理者要]` |
| `PUT`  | `/admin/:id/status`  | 注文のステータスを更新する。                       | `[管理者要]` |
